<div ui-view>

  <ul class="breadcrumb" style="margin-bottom: 5px;">
    <li><a ui-sref="dashboard">Início</a></li>
    <li><a ui-sref="comercial">Comercial</a></li>
    <li class="active">Proposta de Venda</li>
  </ul> <br>

  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12">
    <div class="panel panel-default">
        <div class="panel-heading">Proposta de venda</div>
        <div class="panel-body">
            <div class="control-group">
                <a ui-sref="propostaVenda.add" class="btn btn-success">Novo</a>
                <button ng-click="vm.excluir()" ng-disabled="vm.nothingSelected()" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span>Excluir</button>
            </div>
            <div class="row">
              <div class="col-md-12">
                <div class="control-group">
                    <form class="form-inline" ng-submit="vm.filtrar()">
                      <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                            <label for="vencDespesa">De:</label>
                            <input type="text" class="form-control"
                            uib-datepicker-popup="dd/MM/yyyy"
                            datepicker-mode="'day'"
                            min-mode="'day'"
                            max-mode="'day'"ng-change="vm.filtrar()"
                            ng-click="openDe = true"
                            ng-model="vm.filtro.data.$gte"
                            is-open="openDe"
                            close-text="Fechar"
                            clear-text="Limpar"
                            current-text="Hoje" />
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                            <label for="vencDespesa">Até:</label>
                            <input type="text" class="form-control"
                            uib-datepicker-popup="dd/MM/yyyy"
                            datepicker-mode="'day'"
                            min-mode="'day'"
                            max-mode="'day'"ng-change="vm.filtrar()"
                            ng-click="openAte = true"
                            ng-model="vm.filtro.data.$lt"
                            is-open="openAte"
                            close-text="Fechar"
                            clear-text="Limpar"
                            current-text="Hoje" />
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <label for="seleClienteVenc">Cliente:</label>
                            <select style="width:70%" ng-model="vm.filtro.cliente" ng-change="vm.filtrar()" class="form-control" id="seleClienteVenc">
                              <option value="0">Todos</option>
                              <option value="{{cliente._id}}" ng-repeat="cliente in vm.clientes">{{cliente.nome}}</option>
                            </select>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-12 col-xs-12">
                            <a ng-click="vm.removerFiltros()" href="">Remover filtros</a>
                        </div>
                      </div>

                    </form>
                  </div>
                </div>
              </div>

            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>
                            <div class="checkbox">
                              <label>
                                <input ng-click="vm.selectAll()" ng-model="vm.selector" type="checkbox"><span class="checkbox-material"><span class="check"></span></span>
                              </label>
                            </div>
                        </th>
                        <th>Data da Proposta</th>
                        <th>Cliente</th>
                        <th>Produto(s)</th>
                        <th>&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="item in vm.lista">
                        <td>
                           <div class="checkbox">
                             <label>
                               <input type="checkbox" ng-model="vm.lista[$index].selecionado">
                                <span class="checkbox-material">
                                    <span class="check"></span>
                                </span>
                             </label>
                           </div>
                        </td>
                        <td>{{item.data | date: 'dd/MM/yyyy'}}</td>
                        <td>{{item.cliente.nome}}</td>
                        <td>
                            <ul>
                              <li ng-repeat="p in item.produtos" uib-popover-template="vm.templateUrl" popover-trigger="mouseenter" style="cursor: help;">
                                {{p.produto.id}}
                              </li>
                            </ul>
                          </td>
                        <!-- vm.getTotalListagem(item) -->
                        <td>
                         <a href="/#/proposta-venda/edit/{{item._id}}" class="btn-icon btn-icon-sm info" title="Alterar contrato">
                           <span class="fa fa-edit"></span>
                         </a>
                         <a href="/#/proposta-venda/pdf/{{item._id}}" class="btn-icon btn-icon-sm info" title="Download contrato">
                           <span class="fa fa-file-pdf-o"></span>
                         </a>
                      </td>
                    </tr>

                </tbody>
            </table>
            <uib-pagination
              ng-model="vm.pagination.currentPage"
              total-items="vm.pagination.total"
              items-per-page="vm.pagination.itemsPerPage"
              max-size="5"
              boundary-links="true"
              previous-text="<"
              next-text=">"
              first-text="primeira"
              last-text="ultima"
              >
            </uib-pagination>
        </div>
    </div>
  </div>
</div>