<form class="form" name="contratoForm" novalidate><!-- Inicio Form -->
    <div class="panel panel-default"><!-- Painel Principal -->
        <div class="panel-heading">Proposta de Venda</div>
        <div class="panel-body"><!-- Painel Body -->

            <ul class="nav nav-tabs" style="margin-bottom: 15px;" ng-init="tab = 1">
                <li ng-class="{'active': tab == 1}"><a href="javascript:;" ng-click="tab = 1">Dados do contrato</a></li>
                <li ng-class="{'active': tab == 2}"><a href="javascript:;" ng-click="tab = 2">Produtos</a></li>
            </ul>


            <div id="myTabContent" class="tab-content"><!-- Corpo Tab -->

                <div class="tab-pane fade" id="dados" ng-class="{'active in': tab == 1}"><!-- Inicio Tab dados -->
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                            <label for="cliente">Cliente</label>
                            <select class="form-control" id="cliente" name="cliente" required
                            ng-disabled="vm.form._id"
                            ng-change="vm.listEnderecos()"
                            ng-options="cliente._id as cliente.nome for cliente in vm.clientes" ng-model="vm.form.cliente">
                                <option>Selecione Cliente</option>
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <label for="end">Endereço de uso</label>
                            <select class="form-control" id="end"
                                ng-change="vm.setEndereco()"
                                ng-model="vm.form.enderecoSelecionado"
                            >
                            <option value="0">Selecione...</option>
                            <option ng-repeat="end in vm.enderecos" value="{{end}}" >{{end.logradouro}}</option>

                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <label for="localUso">(Identificação do endereço) Local de Uso do Equipamento</label>
                            <input type="text" id="localUso" ng-model="vm.form.localUso" class="form-control">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="cep">Cep</label>
                            <input type="text" ng-blur="vm.getCep($index)" ui-br-cep-mask  ng-model="vm.form.endereco.cep" id="cep" class="form-control">
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 form-group">
                            <label for="logradouro">Logradouro</label>
                            <input type="text"  ng-model="vm.form.endereco.logradouro" id="logradouro" class="form-control">
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="numero">Número</label>
                            <input type="text"  ng-model="vm.form.endereco.numero" id="numero" class="form-control">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="complemento">Complemento</label>
                            <input type="text"  ng-model="vm.form.endereco.complemento" id="complemento" class="form-control">
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="bairro">Bairro</label>
                            <input type="text"  ng-model="vm.form.endereco.bairro" id="bairro"class="form-control">
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="cidade">Cidade</label>
                            <input type="text"  ng-model="vm.form.endereco.cidade" id="cidade"class="form-control">
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="uf">UF</label>
                            <input type="text"  ng-model="vm.form.endereco.uf" id="uf" class="form-control">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="data">Primeiro Vencimento:</label>
                            <input type="text" class="form-control"
                            uib-datepicker-popup="dd/MM/yyyy"
                            datepicker-mode="'day'"
                            min-mode="'day'"
                            max-mode="'day'"
                            ng-click="openDe = true"
                            ng-model="vm.form.primeiroVencimento"
                            is-open="openDe"
                            close-text="Fechar"
                            clear-text="Limpar"
                            current-text="Hoje"
                            id = "data"/>
                        </div>

                    </div>
                </div><!-- End Tab dados -->

                <div class="tab-pane fade" id="item" ng-class="{'active in': tab == 2}"><!-- Inicio Tab Endereço -->

                        <div class="row">
                            <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                <label for="produtoNome">Produto</label>
                                <input name="produtoNome" autocomplete="off" type="text" typeahead-on-select="vm.addProdutoBag()"
                                  ng-model="vm.bag.produtoModel" id="produtoNome" uib-typeahead="produto as (produto.nome + ' - ' + produto.modelo + ' - ' + produto.id + ' (estoque atual '+produto.quantidade+')') for produto in vm.produtos | filter: $viewValue | limitTo:8" class="form-control">
                            </div>
                            <div class="col-lg-1 col-md-1 col-sm-12 col-xs-12">
                                <label for="quantidade">Quantidade</label>
                                <input type="text" id="quantidade" ng-model="vm.bag.quantidade" class="form-control">
                            </div>
                            <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                <label for="">Unidade</label>
                                <p>{{vm.bag.unidade.sigla}}</p>
                            </div>

                            <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                <label for="valorUnitario">Valor</label>
                                <input type="text" id="valorUnitario" ng-model="vm.bag.valorUnitario" class="form-control" ui-money-mask>
                            </div>
                            <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                              <button type="button" ng-click="vm.addProduto()" class="btn btn-primary"><span class="glyphicon glyphicon-plus"></span> Adicionar</button>
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-md-12">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Produto / Modelo</th>
                                            <th>Quantidade</th>
                                            <th>Valor</th>
                                            <th>Opções</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="produto in vm.form.produtos">
                                            <td>{{produto.produtoModel.nome}}{{produto.produto.nome}} - {{produto.produtoModel.modelo}}{{produto.produto.modelo}} - {{produto.produtoModel.id}}{{produto.produto.id}}</td>
                                            <td>
                                                <input type="text" ng-model="vm.form.produtos[$index].quantidade"> {{produto.produto.unidade.sigla}}{{produto.produtoModel.unidade.sigla}}
                                            </td>
                                            <td>
                                                <input ui-money-mask type="text" ng-model="vm.form.produtos[$index].valorUnitario">
                                            </td>
                                            <td><a href="javascript:;" ng-click="vm.removerProduto($index)">remover</a></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <br>
                        <br>
                        <br>


                        <div class="row">
                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 form-group">
                                    <label for="descontoCompra">Desconto</label>
                                    <input type="text" id="descontoCompra" name="descontoCompra" class="form-control"  ui-money-mask ng-model="vm.form.desconto">
                                </div>
                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 form-group">
                                    <label for="freteCompra">Frete</label>
                                    <input type="text" id="freteCompra" name="freteCompra" class="form-control" ui-money-mask ng-model="vm.form.frete">
                                </div>
                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                    <button type="button" class="btn btn-success" ng-hide="vm.form._id" ng-click="vm.cotarFrete()">Cotar frete</button>
                                </div>
                                 <!--    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 form-group">
                                     <label for="despesasCompra">Despesas adicionais</label>
                                     <input type="text" id="despesasCompra" name="despesasCompra" class="form-control"  ui-money-mask ng-model="vm.form.despesaAdicional">
                                 </div> -->
                                <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                                    <label for="municipioFornecedor">Valor total R$</label><br >
                                    <span>{{vm.getTotal() | currency: 'R$ '}}</span>
                                </div>

                                <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                                    <label for="municipioFornecedor">Valor total com frete R$</label><br >
                                    <span>{{vm.getTotal() + vm.form.frete | currency: 'R$ '}}</span>
                                </div>
                        </div>


                </div><!-- End Tab Dadoas Adicionais -->
            </div>

            <a ui-sref="propostaVenda" class="btn btn-danger">Cancelar</a>
            <button type="submit" ng-click="vm.save(contratoForm.cliente.$valid)"
            ng-disabled = "contratoForm.cliente.$invalid"
            class="btn btn-success">Salvar</button>
        </div>
    </div>
</form><!-- End Form -->