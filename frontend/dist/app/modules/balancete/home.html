<div ui-view>

      <ul class="breadcrumb" style="margin-bottom: 5px;">
        <li><a ui-sref="dashboard">Início</a></li>
        <li><a ui-sref="financeiro">Financeiro</a></li>
        <li class="active">Balancete financeiro</li>
      </ul> <br>

                <div class="panel panel-default">
                    <div class="panel-heading">Balancete financeiro</div>
                    <div class="panel-body">
                        <div class="control-group">
                            <form class="form-inline" ng-submit="vm.filtrar()">
                              <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 form-group">
                                  <label for="vencDespesa">De:</label>
                                  <input type="text" class="form-control"
                                  ng-change="vm.filtrar()"
                                  ng-click="openDe = true"
                                  uib-datepicker-popup="dd/MM/yyyy"
                                  ng-model="vm.filtro.dataPagamento.$gte"
                                  is-open="openDe"
                                  close-text="Fechar"
                                  clear-text="Limpar"
                                  current-text="Hoje" />
                              </div>
                              <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 form-group">
                                  <label for="vencDespesa">Até:</label>
                                  <input type="text" class="form-control"
                                  ng-change="vm.filtrar()"
                                  ng-click="openAte = true"
                                  uib-datepicker-popup="dd/MM/yyyy"
                                  ng-model="vm.filtro.dataPagamento.$lte"
                                  is-open="openAte"
                                  close-text="Fechar"
                                  clear-text="Limpar"
                                  current-text="Hoje" />
                              </div>

                              <div class="col-md-12 col-xs-12">
                                  <a ng-click="vm.removerFiltros()" href="">Remover filtros</a>
                              </div>
                            </form>
                            <div class="row">
                              <div class="col-md-12">
                                &nbsp;
                              </div>
                            </div>
                        </div>

                        <div class="row">
                          <div class="col-md-12">
                            <h4>Balancete do período</h4>
                            <p class="muted">OBS: O Demonstrativo de Resultados considera apenas contas quitadas</p>
                            <p>
                              <a ng-click="vm.exportar('balancete')">Exportar para Excel</a>
                            </p>
                            <hr>
                          </div>
                        </div>

                        <div class="row" id="balancete">
                          <table class="table table-striped table-hover">
                              <tbody>
                                  <tr>
                                      <td class="table-heading">Receitas</td>
                                      <td class="table-heading text-right">Total</td>
                                  </tr>
                                  <tr ng-repeat="cat in vm.categoriasReceitas"  ng-click="vm.getDetails(cat)">
                                      <td>
                                        {{cat._id.categoria.codContabil}}. {{cat._id.categoria.nome}}
                                      </td>
                                      <td class="text-right">{{cat.totalAmount | currency: 'R$ '}}</td>
                                  </tr>
                                  <tr>
                                      <td colspan="2" class="table-footer text-right text-success">TOTAL: {{vm.getTotal('R') | currency: 'R$ '}}</td>
                                  </tr>

                                  <tr>
                                      <td class="table-heading">Despesas</td>
                                      <td class="table-heading text-right">Total</td>
                                  </tr>
                                  <tr ng-repeat="cat in vm.categoriasDespesas" ng-click="vm.getDetails(cat)">
                                      <td>
                                        {{cat._id.categoria.codContabil}}. {{cat._id.categoria.nome}}
                                      </td>
                                      <td class="text-right">{{cat.totalAmount | currency: 'R$ '}}</td>
                                  </tr>
                                  <tr>
                                      <td colspan="2" class="table-footer text-right text-danger">TOTAL: {{vm.getTotal('D') | currency: 'R$ '}}</td>
                                  </tr>
                              </tbody>
                          </table>
                        </div>
                    </div>
                </div>
</div>



<!-- Modal -->
<script type="text/ng-template" id="myModalContent.html">
      <div class="modal-header">
          <h3 class="modal-title">Detalhes balancete categoria: {{item._id.categoria.nome}}</h3>
      </div>
      <div class="modal-body">
            <div class="row" ng-show="receitas.length">
                <div class="col-md-12">
                  <p class="text-success">Receitas</p>
                  <table class="table table-hover">
                   <thead>
                        <tr>
                            <th>Cliente</th>
                            <th>Valor</th>
                            <th>Quitada</th>
                            <th>Juros</th>
                            <th>Descontos</th>
                            <th>Valor Pago</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="item in receitas" ng-class="{'warning': validarAviso(item), 'danger': validarHojeOuAtraso(item), 'success': item.recebido}">
                            <td width="200">{{item.cliente.nome}}</td>
                            <td>{{item.valor | currency: 'R$ '}}</td>
                            <td>{{item.recebido ? (item.dataPagamento | date: 'dd/MM/yyyy' : '+0300') : ''}}</td>
                            <td>{{item.recebido ? (item.juros | currency: 'R$ ') : ''}}</td>
                            <td>{{item.recebido ? (item.desconto | currency: 'R$ ') : ''}}</td>
                            <td>{{item.valorPago | currency: 'R$ '}}</td>
                        </tr>
                    </tbody>
                  </table>
                </div>
            </div>

            <div class="row" ng-show="despesas.length">
              <div class="col-md-12">
                <p class="text-danger">Despesas</p>
                <table class="table table-hover">
                 <thead>
                      <tr>
                          <th>Fornecedor</th>
                          <th>Valor</th>
                          <th>Quitada</th>
                          <th>Juros</th>
                          <th>Descontos</th>
                          <th>Valor Pago</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr ng-repeat="item in despesas" ng-class="{'warning': validarAviso(item), 'danger': validarHojeOuAtraso(item), 'success': item.recebido}">
                          <td width="200">{{item.fornecedor.nome}}</td>
                          <td>{{item.valor | currency: 'R$ '}}</td>
                          <td>{{item.recebido ? (item.dataPagamento | date: 'dd/MM/yyyy' : '+0300') : ''}}</td>
                          <td>{{item.recebido ? (item.juros | currency: 'R$ ') : ''}}</td>
                          <td>{{item.recebido ? (item.desconto | currency: 'R$ ') : ''}}</td>
                          <td>{{item.valorPago | currency: 'R$ '}}</td>
                      </tr>
                  </tbody>
                </table>
              </div>
            </div>
      </div>
      <div class="modal-footer">
          <button class="btn btn-warning" type="button" ng-click="cancel()">Fechar</button>
      </div>
  </script>